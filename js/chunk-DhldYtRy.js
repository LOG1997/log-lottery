import{_ as a}from"./chunk-C3c8BOb5.js";import{u as t,i as l,b as e}from"./chunk-B9lHjrML.js";import{r as o}from"./chunk-Czrwg_dh.js";import{d as n,u as s,s as i,r as d,h as r,a as p,b,t as c,j as m,m as g,F as u,a6 as f,a7 as y,a8 as h,o as x}from"./chunk-BraE6NOK.js";const v={class:"modal-box"},k={class:"text-lg font-bold"},_={class:"py-4"},A={class:"modal-action"},N={method:"dialog",class:"flex gap-3"},T={class:"modal-box"},w={class:"text-lg font-bold"},C={class:"py-4"},P={class:"modal-action"},j={method:"dialog",class:"flex gap-3"},z={class:"min-w-1000px"},D={class:"flex gap-3"},W=["data-tip"],S=["download","href"],J={class:""},O={for:"explore"},L=["data-tip"],M={class:"btn btn-primary btn-sm"},R=n({__name:"PersonAll",setup(n){const{t:R}=s(),V=t().personConfig,{getAllPersonList:$,getAlreadyPersonList:E}=i(V),F=d(),I=d();async function q(a){const t=await o(a.target.files[0]),l=f(t,{type:"binary",cellDates:!0}),n=l.Sheets[l.SheetNames[0]],s=y.sheet_to_json(n),i=e(s);V.resetPerson(),V.addNotPersonList(i)}function B(){let a=JSON.parse(JSON.stringify($.value));for(let e=0;e<a.length;e++)delete a[e].x,delete a[e].y,delete a[e].id,delete a[e].createTime,delete a[e].updateTime,delete a[e].prizeId,a[e].isWin?a[e].isWin=l.global.t("data.yes"):a[e].isWin=l.global.t("data.no"),a[e].prizeTime=a[e].prizeTime.join(","),a[e].prizeName=a[e].prizeName.join(",");let t=JSON.stringify(a);if(t=t.replaceAll(/uid/g,l.global.t("data.number")).replaceAll(/isWin/g,l.global.t("data.isWin")).replaceAll(/department/g,l.global.t("data.department")).replaceAll(/name/g,l.global.t("data.name")).replaceAll(/identity/g,l.global.t("data.identity")).replaceAll(/prizeName/g,l.global.t("data.prizeName")).replaceAll(/prizeTime/g,l.global.t("data.prizeTime")),a=JSON.parse(t),a.length>0){const t=y.json_to_sheet(a),l=y.book_new();y.book_append_sheet(l,t,"Sheet1"),h(l,"data.xlsx")}}function G(){V.resetAlreadyPerson()}function H(){V.deleteAllPerson()}const K=[{label:l.global.t("data.number"),props:"uid"},{label:l.global.t("data.name"),props:"name"},{label:l.global.t("data.department"),props:"department"},{label:l.global.t("data.avatar"),props:"avatar",formatValue:a=>a.avatar?`<img src="${a.avatar}" alt="avatar" style="width: 50px; height: 50px;"/>`:"-"},{label:l.global.t("data.identity"),props:"identity"},{label:l.global.t("data.isWin"),props:"isWin",formatValue:a=>a.isWin?l.global.t("data.yes"):l.global.t("data.no")},{label:l.global.t("data.operation"),actions:[{label:l.global.t("data.delete"),type:"btn-error",onClick:a=>{!function(a){V.deletePerson(a)}(a)}}]}];return r((()=>{})),(t,l)=>(x(),p(u,null,[b("dialog",{id:"my_modal_1",ref_key:"resetDataDialog",ref:F,class:"border-none modal"},[b("div",v,[b("h3",k,c(m(R)("dialog.titleTip")),1),b("p",_,c(m(R)("dialog.dialogResetWinner")),1),b("div",A,[b("form",N,[b("button",{class:"btn",onClick:l[0]||(l[0]=a=>F.value.close())},c(m(R)("button.cancel")),1),b("button",{class:"btn",onClick:G},c(m(R)("button.confirm")),1)])])])],512),b("dialog",{id:"my_modal_1",ref_key:"delAllDataDialog",ref:I,class:"border-none modal"},[b("div",T,[b("h3",w,c(m(R)("dialog.titleTip")),1),b("p",C,c(m(R)("dialog.dialogDelAllPerson")),1),b("div",P,[b("form",j,[b("button",{class:"btn",onClick:l[1]||(l[1]=a=>I.value.close())},c(m(R)("button.cancel")),1),b("button",{class:"btn",onClick:H},c(m(R)("button.confirm")),1)])])])],512),b("div",z,[b("h2",null,c(m(R)("viewTitle.personManagement")),1),b("div",D,[b("button",{class:"btn btn-error btn-sm",onClick:l[2]||(l[2]=a=>I.value.showModal())},c(m(R)("button.allDelete")),1),b("div",{class:"tooltip tooltip-bottom","data-tip":m(R)("tooltip.downloadTemplateTip")},[b("a",{class:"no-underline btn btn-secondary btn-sm",download:m(R)("data.xlsxName"),target:"_blank",href:`/log-lottery/${m(R)("data.xlsxName")}`},c(m(R)("button.downloadTemplate")),9,S)],8,W),b("div",J,[b("label",O,[b("div",{class:"tooltip tooltip-bottom","data-tip":m(R)("tooltip.uploadExcelTip")},[b("input",{id:"explore",type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:q},null,32),b("span",M,c(m(R)("button.importData")),1)],8,L)])]),b("button",{class:"btn btn-error btn-sm",onClick:l[3]||(l[3]=a=>F.value.showModal())},c(m(R)("button.resetData")),1),b("button",{class:"btn btn-accent btn-sm",onClick:B},c(m(R)("button.exportResult")),1),b("div",null,[b("span",null,c(m(R)("table.luckyPeopleNumber"))+":",1),b("span",null,c(m(E).length),1),l[4]||(l[4]=b("span",null," / ",-1)),b("span",null,c(m($).length),1)])]),g(a,{"table-columns":K,data:m($)},null,8,["data"])])],64))}});export{R as default};
