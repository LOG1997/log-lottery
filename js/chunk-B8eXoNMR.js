import{d as e,o as t,c as l,n as s,r as a,a as n,Q as o,g as u,ay as i,az as c,aA as r,aB as d,i as p,b,ac as m,y as f,z as h,j as x,aC as w,f as g,B as v,l as C,p as k,I as y,a6 as z,aD as U,h as P,Z as L,_ as D,aE as j,X as V,a4 as $,a5 as S,R as _}from"./chunk-Bpe8Il_K.js";import{u as A,i as I,e as M}from"./chunk-DpwHy-20.js";import{_ as N}from"./chunk-CdEVcDFJ.js";const B=["data-tip"],T=e({__name:"index",props:{tip:{},type:{default:"info"},direction:{default:"top"},size:{default:"sm"}},setup(e){const m=e,f={"2xs":"w-2 h-2",xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-7 h-7","2xl":"w-8 h-8"},h=b(()=>[`tooltip-${m.direction}`]),x=b(()=>[`w-${f[m.size]}`]);return(b,m)=>(t(),l("div",{class:s(["tooltip",h.value]),"data-tip":e.tip},[a(b.$slots,"content"),a(b.$slots,"default",{},()=>[n("div",{class:s([x.value,"hover:text-primary cursor-pointer"])},["warning"===e.type?(t(),o(u(i),{key:0,class:"w-full h-full text-warning"})):"info"===e.type?(t(),o(u(c),{key:1,class:"w-full h-full"})):"success"===e.type?(t(),o(u(r),{key:2,class:"w-full h-full text-success"})):"error"===e.type?(t(),o(u(d),{key:3,class:"w-full h-full text-error"})):p("",!0)],2)])],10,B))}});function H(){const e=m.useToast(),t=f.createInstance({name:"imgStore"}),l=A().prizeConfig,s=A().globalConfig,{getPrizeConfig:a,getCurrentPrize:n}=h(l),{getImageList:o}=h(s),u=x([]),i=x(w(a.value)),c=x();return g(()=>{!async function(){(await t.keys()).length>0&&t.iterate((e,t)=>{u.value.push({key:t,value:e})})}()}),v(()=>i.value,e=>{l.setPrizeConfig(e)},{deep:!0}),{addPrize:function(){const t={id:(new Date).getTime().toString(),name:I.global.t("data.prizeName"),sort:0,isAll:!1,count:1,isUsedCount:0,picture:{id:"",name:"",url:""},separateCount:{enable:!1,countList:[]},desc:"",isUsed:!1,isShow:!0,frequency:1};i.value.push(t),e.success(I.global.t("error.success"))},resetDefault:function(){l.resetDefault(),i.value=w(a.value),e.success(I.global.t("error.success"))},delAll:async function(){i.value=[],e.success(I.global.t("error.success"))},delItem:function(t){l.deletePrizeConfig(t.id),e.success(I.global.t("error.deleteSuccess"))},prizeList:i,currentPrize:n,selectedPrize:c,submitData:function(e){c.value.separateCount.countList=e,c.value=null},changePrizePerson:function(e){let t=-1;for(let l=0;l<i.value.length;l++)if(i.value[l].id===e.id){t=l;break}t>-1&&(i.value[t].separateCount.countList=[],i.value[t].isUsed?i.value[t].isUsedCount=i.value[t].count:i.value[t].isUsedCount=0)},changePrizeStatus:function(e){e.isUsed?e.isUsedCount=0:e.isUsedCount=e.count,e.separateCount.countList=[],e.isUsed=!e.isUsed},selectPrize:function(e){c.value=e,c.value.isUsedCount=0,c.value.isUsed=!1,c.value.separateCount.countList.length>1||(c.value.separateCount={enable:!0,countList:[{id:"0",count:e.count,isUsedCount:0}]})},localImageList:o}}const R={class:"flex w-full gap-3"},q={role:"alert",class:"w-full my-4 alert alert-info"},E={class:"flex items-center justify-center max-w-xs px-2 handle form-control"},Q={class:"w-1/2 max-w-xs form-control"},X={class:"label"},Z={class:"label-text"},F=["onUpdate:modelValue","placeholder"],G={class:"flex items-center w-1/2 max-w-xs gap-2 form-control"},J={class:"label"},K={class:"label-text"},O=["checked","onChange"],W={class:"w-1/2 max-w-2xl form-control"},Y={class:"label"},ee={class:"label-text"},te=["onUpdate:modelValue","placeholder","onChange"],le=["data-tip"],se=["value","max"],ae={class:"flex items-center w-1/2 max-w-xs gap-2 form-control"},ne={class:"label"},oe={class:"label-text"},ue=["checked","onChange"],ie={class:"w-full max-w-xs form-control"},ce={class:"label"},re={class:"label-text"},de=["onUpdate:modelValue"],pe={key:0,value:{id:"",name:"",url:""}},be={disabled:"",selected:""},me=["title","value"],fe={class:"truncate w-option-xs"},he={key:0,class:"w-full max-w-xs form-control"},xe={class:"label"},we={class:"label-text"},ge=["onClick"],ve={key:0,class:"flex flex-wrap w-full h-full gap-1 p-0 pt-1 m-0 cursor-pointer"},Ce=["data-tip"],ke={key:1,class:"btn btn-secondary btn-xs"},ye={class:"w-full max-w-xs form-control"},ze={class:"label"},Ue={class:"label-text"},Pe={class:"flex gap-2"},Le=["onClick"],De=e({__name:"PrizeConfig",setup(e){const{addPrize:a,resetDefault:o,delAll:i,delItem:c,prizeList:r,currentPrize:d,selectedPrize:b,submitData:m,changePrizePerson:f,changePrizeStatus:h,selectPrize:x,localImageList:w}=H(),{t:g}=C();return(e,v)=>(t(),l("div",null,[k(N,{title:u(g)("viewTitle.prizeManagement")},{buttons:y(()=>[n("div",R,[n("button",{class:"btn btn-info btn-sm",onClick:v[0]||(v[0]=(...e)=>u(a)&&u(a)(...e))},P(u(g)("button.add")),1),n("button",{class:"btn btn-info btn-sm",onClick:v[1]||(v[1]=(...e)=>u(o)&&u(o)(...e))},P(u(g)("button.resetDefault")),1),n("button",{class:"btn btn-error btn-sm",onClick:v[2]||(v[2]=(...e)=>u(i)&&u(i)(...e))},P(u(g)("button.allDelete")),1)])]),alerts:y(()=>[n("div",q,[v[4]||(v[4]=n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-6 h-6 stroke-current shrink-0"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),n("span",null,P(u(g)("dialog.tipResetPrize")),1)])]),_:1},8,["title"]),k(u(U),{modelValue:u(r),"onUpdate:modelValue":v[3]||(v[3]=e=>z(r)?r.value=e:null),animation:150,handle:".handle",class:"p-0 m-0"},{default:y(()=>[(t(!0),l(L,null,D(u(r),e=>(t(),l("div",{key:e.id,class:s(["flex items-center justify-center gap-10 py-5",u(d).id===e.id?"border border-dotted rounded-xl":null])},[n("label",E,[k(u(j),{class:"w-10 h-10 cursor-move handle"})]),n("label",Q,[n("div",X,[n("span",Z,P(u(g)("table.prizeName")),1)]),V(n("input",{"onUpdate:modelValue":t=>e.name=t,type:"text",placeholder:u(g)("placeHolder.name"),class:"w-full max-w-xs input-sm input input-bordered"},null,8,F),[[$,e.name]])]),n("label",G,[n("div",J,[n("span",K,P(u(g)("table.fullParticipation")),1)]),n("input",{type:"checkbox",checked:e.isAll,class:"border-solid checkbox checkbox-secondary border",onChange:t=>e.isAll=!e.isAll},null,40,O)]),n("label",W,[n("div",Y,[n("span",ee,P(u(g)("table.numberParticipants")),1)]),V(n("input",{"onUpdate:modelValue":t=>e.count=t,type:"number",placeholder:u(g)("placeHolder.winnerCount"),class:"w-full max-w-xs p-0 m-0 input-sm input input-bordered",onChange:t=>u(f)(e)},null,40,te),[[$,e.count]]),n("div",{class:"tooltip tooltip-bottom w-full","data-tip":`${u(g)("table.isDone")+e.isUsedCount}/${e.count}`},[n("progress",{class:"progress w-full",value:e.isUsedCount,max:e.count},null,8,se)],8,le)]),n("label",ae,[n("div",ne,[n("span",oe,P(u(g)("table.isDone")),1)]),n("input",{type:"checkbox",checked:e.isUsed,class:"border-solid checkbox checkbox-secondary border",onChange:t=>u(h)(e)},null,40,ue)]),n("label",ie,[n("div",ce,[n("span",re,P(u(g)("table.image")),1)]),V(n("select",{"onUpdate:modelValue":t=>e.picture=t,class:"truncate select select-warning select-sm"},[e.picture.id?(t(),l("option",pe,"âŒ")):p("",!0),n("option",be,P(u(g)("table.selectPicture")),1),(t(!0),l(L,null,D(u(w),e=>(t(),l("option",{key:e.id,title:e.name,class:"w-full max-w-full",value:e},[n("span",fe,P(e.name),1)],8,me))),128))],8,de),[[S,e.picture]])]),e.separateCount?(t(),l("label",he,[n("div",xe,[n("span",we,P(u(g)("table.onceNumber")),1),k(u(T),{tip:u(g)("tooltip.onceNumberMax")},null,8,["tip"])]),n("div",{class:"flex justify-start w-full h-full",onClick:t=>u(x)(e)},[e.separateCount.countList.length?(t(),l("ul",ve,[(t(!0),l(L,null,D(e.separateCount.countList,e=>(t(),l("li",{key:e.id,class:"relative flex items-center justify-center w-8 h-8 bg-slate-600/60 separated"},[n("div",{class:"flex items-center justify-center w-full h-full tooltip","data-tip":`${u(g)("tooltip.doneCount")+e.isUsedCount}/${e.count}`},[n("div",{class:"absolute left-0 z-50 h-full bg-blue-300/80",style:_(`width:${100*e.isUsedCount/e.count}%`)},null,4),n("span",null,P(e.count),1)],8,Ce)]))),128))])):(t(),l("button",ke,P(u(g)("button.setting")),1))],8,ge)])):p("",!0),n("label",ye,[n("div",ze,[n("span",Ue,P(u(g)("table.operation")),1)]),n("div",Pe,[n("button",{class:"btn btn-error btn-xs",onClick:t=>u(c)(e)},P(u(g)("button.delete")),9,Le)])])],2))),128))]),_:1},8,["modelValue"]),k(M,{"total-number":u(b)?.count,"separated-number":u(b)?.separateCount.countList,onSubmitData:u(m)},null,8,["total-number","separated-number","onSubmitData"])]))}});export{De as default};
